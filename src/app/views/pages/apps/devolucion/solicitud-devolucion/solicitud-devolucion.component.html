<re-portlet>
    <re-portlet-header [title]="'SOLICITUD DE DEVOLUCION DE GARANTIAS'" [class]="'kt-portlet__head--lg'">


    </re-portlet-header>
    <re-portlet-body>
        <mat-vertical-stepper #stepper [linear]="true">
            <mat-step label="Información de la operación">
                <div class="row">
                    <div class="col-md-4">
                        <mat-form-field class="mat-form-field-fluid">
                            <input matInput [formControl]="numeroOperacion" placeholder="Numero Operacion: ">
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2">
                        <label style="font-weight:bold">Proceso:</label>
                    </div>
                    <div class="col-md-4">
                        <mat-form-field class="example-full-width">
                            <input matInput [formControl]="estadoProceso">
                        </mat-form-field>
                    </div>
                </div>

            </mat-step>
            <mat-step label="Datos Personales del cliente">
                <div class="row">

                    <div class="col-md-2">
                        <label style="font-weight:bold">Cliente:</label>
                    </div>
                    <div class="col-md-4">
                        <mat-form-field class="example-full-width">
                            <input matInput [formControl]="nombresCompletos" readonly>
                        </mat-form-field>
                    </div>

                    <div class="col-md-2">
                        <label style="font-weight:bold">Cédula:</label>
                    </div>
                    <div class="col-md-4">
                        <mat-form-field class="example-full-width">
                            <input matInput [formControl]="cedulaCliente" readonly>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">

                    <div class="col-md-2">
                        <label style="font-weight:bold">Nivel de Educación:</label>
                    </div>
                    <div class="col-md-4">
                        <mat-form-field class="example-full-width">
                            <input matInput [formControl]="nivelEducacion" readonly>
                        </mat-form-field>
                    </div>

                </div>

                <div class="row">
                    <div class="col-md-1">
                        <label style="font-weight:bold">Género:</label>
                    </div>
                    <div class="col-md-3">
                        <mat-form-field class="example-full-width">
                            <input matInput [formControl]="genero" readonly>
                        </mat-form-field>
                    </div>
                    <div class="col-md-1">
                        <label style="font-weight:bold">Estado Civil:</label>
                    </div>
                    <div class="col-md-3">
                        <mat-form-field class="example-full-width">
                            <input matInput [formControl]="estadoCivil" readonly>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-1">
                        <label style="font-weight:bold">Fecha de Nacimiento:</label>
                    </div>
                    <div class="col-md-3">
                        <mat-form-field class="example-full-width">
                            <input matInput [formControl]="fechaNacimiento" [value]="fechaNacimiento.value | rDate"
                                readonly>
                        </mat-form-field>
                    </div>
                    <div class="col-md-1">
                        <label style="font-weight:bold">Nacionalidad:</label>
                    </div>
                    <div class="col-md-3">
                        <mat-form-field class="example-full-width">
                            <input matInput [formControl]="nacionalidad" readonly>
                        </mat-form-field>
                    </div>
                    <div class="col-md-1">
                        <label style="font-weight:bold">Lugar de Nacimiento:</label>
                    </div>
                    <div class="col-md-3">
                        <mat-form-field class="example-full-width">
                            <input matInput [formControl]="lugarNacimiento" readonly>
                        </mat-form-field>
                    </div>

                </div>
                <div class="row">
                    <div class="col-md-1">
                        <label style="font-weight:bold">Edad:</label>
                    </div>
                    <div class="col-md-3">
                        <mat-form-field class="example-full-width">
                            <input matInput [formControl]="edad" readonly>
                        </mat-form-field>
                    </div>
                </div>
            </mat-step>
            <mat-step label="Detalle de Crédito">

                <div class="mat-table__wrapper">

                    <mat-table #table class="mat-elevation-z8" [dataSource]="dataSourceContrato" >

                        <ng-container matColumnDef="fechaAprobacion">
                            <mat-header-cell *matHeaderCellDef>Fecha de Aprobación</mat-header-cell>
                            <mat-cell *matCellDef="let element"> {{element.fechaAprobacion | rDate}}</mat-cell>

                        </ng-container>
                        <ng-container matColumnDef="fechaVencimiento">
                            <mat-header-cell *matHeaderCellDef >Fecha de Vencimiento</mat-header-cell>
                            <mat-cell *matCellDef="let element"> {{element.fechaVencimiento | rDate}} </mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="monto">
                            <mat-header-cell *matHeaderCellDef >Monto</mat-header-cell>
                            <mat-cell *matCellDef="let element"> {{element.monto | number: '1.2'}} </mat-cell>

                        </ng-container>

                        <mat-header-row *matHeaderRowDef="displayedColumnsCredito"></mat-header-row>
                        <mat-row *matRowDef="let row; columns: displayedColumnsCredito;"></mat-row>
                    </mat-table>
                </div>
            </mat-step>
            <mat-step label="Detalle de Garantía">
                <kt-tabla-tasacion *ngIf="this.wrapperSoft && this.wrapperSoft.garantias;" [data]='this.wrapperSoft.garantias' [tipo]="'DV'"></kt-tabla-tasacion>
            </mat-step>
            <mat-step label="Gestión de Devolución">
                <div class="row">
                    <div class="col-md-2">
                        <label style="font-weight:bold">Tipo de Cliente:</label>
                    </div>
                    <div class="col-md-4">
                        <mat-form-field>
                            <mat-select placeholder="" [formControl]="tipoCliente">
                                <mat-option *ngFor="let element of catTipoCliente " [value]="element">
                                    {{ element.nombre }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2">
                        <label style="font-weight:bold">Observaciones:</label>
                    </div>
                    <div class="col-md-8">
                        <mat-form-field class="example-full-width">
                            <textarea matInput [formControl]="observaciones"> </textarea>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2">
                        <label style="font-weight:bold">Agencia de entrega :</label>
                    </div>
                    <div class="col-md-4">
                        <mat-form-field>
                            <mat-select placeholder="" [formControl]="agenciaEntrega">
                                <mat-option *ngFor="let element of catAgencia" [value]="element">
                                    {{element.nombre}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2">
                        <label style="font-weight:bold">Valor apróximado de custodia :</label>
                    </div>
                    <div class="col-md-4">
                        <mat-form-field class="example-full-width">
                            <input matInput [formControl]="valorCustodia" readonly>
                        </mat-form-field>
                    </div>
                </div>
                <div *ngIf="this.tipoCliente.value.codigo == 'HER'">
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="example-full-width">
                                <input matInput [formControl]="cedulaHeredero" placeholder="Cédula Heredero">
                                <mat-error>{{ getErrorMessage("cedulaHeredo") }}</mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="example-full-width">
                                <input matInput [formControl]="nombreHeredero" placeholder="Nombre Heredero">
                                <mat-error>{{ getErrorMessage("nombreHeredo") }}</mat-error>
                            </mat-form-field>
                        </div>

                        <button mat-stroked-button color="primary" (click)="agregarHeredero()">
                            <mat-icon style="font-size: 24px;" color="primary" matTooltipPosition="above">search
                            </mat-icon>
                            <span color="primary">Agregar </span>
                        </button>
                    </div>

                    <div class="mat-table__wrapper">
                        <mat-table #table class="mat-elevation-z8" [dataSource]="dataSourceHeredero" matSort
                            #sort1="matSort" matSortActive="primerNombre" matSortDirection="asc" matSortDisableClearM>

                            <ng-container matColumnDef="cedula">
                                <mat-header-cell *matHeaderCellDef>Cédula</mat-header-cell>
                                <mat-cell *matCellDef="let element"> {{element.cedula}}</mat-cell>

                            </ng-container>
                            <ng-container matColumnDef="nombre">
                                <mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</mat-header-cell>
                                <mat-cell *matCellDef="let element"> {{element.nombre}} </mat-cell>

                            </ng-container>

                            <mat-header-row *matHeaderRowDef="displayedColumnsHeredero"></mat-header-row>
                            <mat-row *matRowDef="let row; columns: displayedColumnsHeredero;"></mat-row>

                        </mat-table>

                    </div>
                </div>
                <div class="row">
                    <div class="col-4 offset-4">
                        <button mat-button (click)="registrarDevolucion()">Registrar Devolucion</button>
                    </div>
                </div>
            </mat-step>

            <mat-step label="Documento Habilitantes">
                <re-habilitante [proceso]="'SOLICITUD'" [useType]="'FORM'"   [referencia]="idReferencia" > </re-habilitante>
            </mat-step>
        </mat-vertical-stepper>
        <div>
            <button mat-button (click)="solicitarAprobacion()">Solicitar Aprobacion</button>
        </div>

    </re-portlet-body>

</re-portlet>