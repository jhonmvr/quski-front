<div class="spinner-container" *ngIf="loading | async">
    <mat-spinner class="spiner"></mat-spinner>
</div>
<re-portlet>
    <re-portlet-header [title]="'Excepción De Cobertura'" [class]="'kt-portlet__head--lg'">
        <ng-container ktPortletTools>
            <a [routerLink]="['../../']" matTooltip="Regresar al listado"
                style="font-size: 12px; vertical-align: middle;">
                <mat-icon style="font-size: 24px;" matTooltipPosition="above" matTooltip="" class="orange-icon">
                    arrow_back</mat-icon>
                <span style="position: relative; top: -10px; margin-left: 5px;" class="orange-icon">Regresar</span>
            </a>
            <a href="javascript:void(0);" (click)="submit()" matTooltip="Enviar Respuesta"
                style="font-size: 12px; vertical-align: middle;">
                <mat-icon style="font-size: 24px;" matTooltipPosition="above" matTooltip="" class="blue-icon">save
                </mat-icon>
                <span style="position: relative; top: -10px; margin-left: 5px;" class="blue-icon">Enviar
                    Respuesta</span>
            </a>
        </ng-container>
    </re-portlet-header>

    <re-portlet-body>
        <mat-vertical-stepper>
            <mat-step>
                <ng-template matStepLabel>Datos Contacto Cliente</ng-template>
                <form [formGroup]="formDatoContacto">
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field>
                                <input matInput [formControl]="telefonoDomicilio" placeholder="Teléfono Domicilio " />
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field>
                                <input matInput [formControl]="telefonoAdicional" placeholder="Teléfono Adicional " />
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field>
                                <input matInput [formControl]="telefonoMovil" placeholder="Teléfono Móvil " />
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field>
                                <input matInput [formControl]="telefonoOficinaOtros"
                                    placeholder="Teléfono Oficina Otros " />
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field>
                                <input matInput [formControl]="correoElectronico" placeholder="Correo Eléctronico " />
                            </mat-form-field>
                        </div>
                    </div>
                </form>
            </mat-step>
            <mat-step>
                <ng-template matStepLabel>Datos De Negociación</ng-template>
                <div class="kt-form">
                    <form [formGroup]="formDatosNegociacion">
                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="tipoProceso" placeholder="Tipo de proceso" matInput />
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="estadoNegociacion" placeholder="Estado de Negociación"
                                        matInput />
                                </mat-form-field>
                            </div>

                        </div>

                        <div class="row">
                            <div class="col-6">
                                <mat-form-field class="mat-form-field-fluid">
                                    <mat-label>Fecha de Creación</mat-label>
                                    <input matInput #inputFechaCreacion [matDatepicker]="pickerFechaCreacion"
                                        [formControl]="fechaCreacion" required="true" />
                                    <mat-datepicker-toggle matSuffix [for]="pickerFechaCreacion">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #pickerFechaCreacion></mat-datepicker>
                                </mat-form-field>
                                <mat-form-field class="mat-form-field-fluid">
                                    <mat-label>Fecha de Actualización</mat-label>
                                    <input matInput #inputFechaActualizacion [matDatepicker]="pickerFechaActualizacion"
                                        [formControl]="fechaActualizacion" required="true" />
                                    <mat-datepicker-toggle matSuffix [for]="pickerFechaActualizacion">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #pickerFechaActualizacion></mat-datepicker>
                                </mat-form-field>
                            </div>
                        </div>
                    </form>
                </div>
            </mat-step>


            <mat-step>
                <ng-template matStepLabel>Variables crediticias </ng-template>
                <div class="row mt-2">
                    <div class="col-md-8">
                        <ng-container *ngIf="dataPopup">
                            <kt-tabla-variables-crediticias [dataPopup]='dataPopup'>

                            </kt-tabla-variables-crediticias>
                        </ng-container>
                    </div>
                </div>
            </mat-step>
            <mat-step>
                <ng-template matStepLabel>Riesgo Acumulado </ng-template>
                <div class="row mt-2">
                    <div class="col">
                        <ng-container *ngIf="dataPopup">
                            <kt-tabla-riesgo-acumulado [idCliente]="entidadNegociacion.tbQoCliente.id"
                                [isPaged]="false">
                            </kt-tabla-riesgo-acumulado>
                        </ng-container>
                    </div>
                </div>
            </mat-step>
            <mat-step [stepControl]="formOpciones">
                <ng-template matStepLabel>Opciones de Crédito </ng-template>
                <div class="row">
                    <div class="col">
                        <kt-tabla-oferta-calculadora *ngIf="consultaOferta" [consulta]='consultaOferta'
                            (entidades)='traerEntidadesOpciones($event)'></kt-tabla-oferta-calculadora>
                    </div>
                </div>

            </mat-step>



            <mat-step>
                <ng-template matStepLabel>Excepción</ng-template>
                <div class="kt-form">
                    <form [formGroup]="formDatosExcepcion">
                        <div class="row mt-3">
                            <div class="col-md-6">
                                <mat-card class="warning">
                                    <span class="material-icons warning-icons">report_problem </span>
                                    <span>{{mensaje}}</span>

                                </mat-card>
                            </div>
                        </div>


                        <mat-slider thumbLabel [displayWith]="formatLabel" tickInterval="1000" min="0" max="100"
                            (change)="slideChange($event)" vertical invert>
                            <mat-label>"Porcentaje de Excepcion"</mat-label>
                        </mat-slider>

                        <mat-form-field>
                            <input [formControl]="porcentaje" placeholder="Porcentaje de Excepción" matInput
                                [(ngModel)]="this.valor" readonly />
                        </mat-form-field>

                        <div class="row mt-3">
                            <div class="col-md-8">
                                <mat-label> Observacion Del Asesor: </mat-label>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-xl-8">
                                <textarea class="form-control border" rows="3" [formControl]="observacionAsesor"
                                    placeholder="Observacion Del Asesor: " matInput> {{ observacionAsesor }}</textarea>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-8">
                                <mat-label> Observacion Del Aprobador: </mat-label>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-xl-8">
                                <textarea class="form-control border" [formControl]="observacionAprobador" rows="5"
                                    placeholder="Observacion Del Aprobador: "
                                    matInput>{{ observacionAprobador }}</textarea>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class=" offset-3 offset-lg-2 col-xl-8">
                                <mat-radio-group [formControl]="radioB" (change)="capturaHoraAtencion()">
                                    <mat-radio-button value="APROBADO">Aprobar Excepcion</mat-radio-button>
                                    <mat-radio-button value="NEGADO">Negar Excepcion</mat-radio-button>
                                </mat-radio-group>



                            </div>
                        </div>
                    </form>
                </div>
            </mat-step>
        </mat-vertical-stepper>
    </re-portlet-body>
    <re-portlet-footer></re-portlet-footer>
</re-portlet>
