<div class="spinner-container" *ngIf="loading | async"><mat-spinner class="spiner"></mat-spinner></div>
<re-portlet>
    <re-portlet-header [title]="'Excepcion Cliente'" [class]="'kt-portlet__head--lg'">
    <ng-container ktPortletTools>
        <a [routerLink]="['../../']" matTooltip="Regresar al listado" style="font-size: 12px; vertical-align: middle;">
            <mat-icon style="font-size: 24px;" matTooltipPosition="above" matTooltip="" class="orange-icon">arrow_back</mat-icon>
            <span style="position: relative; top: -10px; margin-left: 5px;" class="orange-icon">Regresar</span>
          </a>
        <a href="javascript:void(0);" (click)="enviarRespuesta()" matTooltip="Enviar Respuesta" style="font-size: 12px; vertical-align: middle;">
            <mat-icon style="font-size: 24px;" matTooltipPosition="above" matTooltip="" class="blue-icon">save</mat-icon>
            <span style="position: relative; top: -10px; margin-left: 5px;" class="blue-icon">Enviar Respuesta</span>
        </a>
    </ng-container>
    </re-portlet-header>

    <re-portlet-body>
        <mat-vertical-stepper>
            <mat-step>
                <ng-template matStepLabel>Datos de Operacion</ng-template>
                <form [formGroup]="formDatosOperacion">
                    <div class="row">
                        <div class="col-md-4">
                            <mat-form-field>
                                <input matInput [formControl]="nombresCompletos" placeholder="Nombres Completos "/>
                            </mat-form-field>
                        </div>
                        <div class="col-md-4">
                            <mat-form-field>
                                <input [formControl]="identificacion" placeholder="C.I." matInput numeric numericType="number"  (keypress)="numberOnly($event)"/>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <mat-form-field>
                                <input matInput [formControl]="nombreProceso" placeholder="Proceso"/>
                            </mat-form-field>
                        </div>                            
                    </div>
                </form>
            </mat-step>
            <mat-step>
                <ng-template matStepLabel>Datos Del Cliente</ng-template>
                <div class="kt-form">
                    <form [formGroup]="formDatosCliente">
                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="tipoIdentificacion" placeholder="Tipo de identificacion" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="identificacionC" placeholder="RUC / C.I / Pasaporte" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="aprobadoWebMupi" placeholder="Aprobado Web Mupi" matInput/>
                                </mat-form-field>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="primerNombre" placeholder="Primer Nombre" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="segundoNombre" placeholder="Segundo Nombre" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="separacionDeBienes" placeholder="Separacion de Bienes" matInput/>
                                </mat-form-field>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="apellidoPaterno" placeholder="Apellido Paterno" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="apellidoMaterno" placeholder="Apellido Materno" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="cargaFamiliar" placeholder="Cargas Familiares" matInput/>
                                </mat-form-field>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="genero" placeholder="Genero" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="estadoCivil" placeholder="Estado Civil" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="lugarDeNacimiento" placeholder="Lugar De Nacimiento" matInput/>
                                </mat-form-field>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="fechaDeNacimiento" placeholder="Fecha De Nacimiento" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="nacionalidad" placeholder="Nacionalidad" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="edad" placeholder="Edad" matInput/>
                                </mat-form-field>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="nivelDeEducacion" placeholder="Nivel De Educacion" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="actividadEconomica" placeholder="Actividad Economica" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="ultimaFechaDeActualizacionDeCliente" placeholder="Ultima fecha de actualizacion de cliente" matInput/>
                                </mat-form-field>
                            </div>
                        </div>
                    </form>
                </div>
            </mat-step>
            <mat-step>
                <ng-template matStepLabel>Datos De contacto Del Cliente</ng-template>
                <div class="kt-form">
                    <form [formGroup]="formDatosContacto">
                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="telefonoDomicilio" placeholder="Telefono Domicilio:" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="telefonoAdicional" placeholder="Telefono Adicional:" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="telefonoMovil" placeholder="Telefono Movil:" matInput/>
                                </mat-form-field>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="telefonoOficina" placeholder="Telefono de Oficina/Otros:" matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="correo" placeholder="Correo Electronico:" matInput/>
                                </mat-form-field>
                            </div>
                        </div>
                    </form>
                </div>
            </mat-step>
            <mat-step>
                <ng-template matStepLabel>Datos De Negociacion</ng-template>
                <div class="kt-form">
                    <form [formGroup]="formDatosNegociacion">
                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="tipoProcesoNegociacion" placeholder="Tipo De Proceso: " matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="estadoNegociacion" placeholder="Estado de Negociacion: " matInput/>
                                </mat-form-field>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="fechaDeCreacionNegociacion" placeholder="Fecha de Creacion: " matInput/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-4">
                                <mat-form-field>
                                    <input [formControl]="ultimaFechaDeActualizacionNegociacion" placeholder="Fecha de Actualizacion: " matInput/>
                                </mat-form-field>
                            </div>
                        </div>
                    </form>
                </div>
            </mat-step>
            <mat-step>
                <ng-template matStepLabel>Variables crediticias </ng-template>
                
                    <mat-table #table class="mat-elevation-z8" [dataSource]="dataSourceVariablesCrediticias" matSort #sort1="matSort"
                        matSortActive="orden" matSortDirection="asc" matSortDisableClear>
                        <ng-container matColumnDef="orden">
                            <mat-header-cell *matHeaderCellDef>Orden</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                {{element.orden}}
                            </mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="variable">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>Variable</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                {{element.nombre}}
                            </mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="valor">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>Valor</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                {{element.valor}}
                            </mat-cell>
                        </ng-container>
                        <mat-header-row *matHeaderRowDef="displayedColumnsVariablesCrediticias"></mat-header-row>
                        <mat-row *matRowDef="let row; columns: displayedColumnsVariablesCrediticias"></mat-row>
                    </mat-table>
            </mat-step>
            <mat-step>
                <ng-template matStepLabel>Riesgo Acumulado </ng-template>
                <mat-dialog-content>
                    <div class="mat-table__wrapper">
                        <mat-table #table class="mat-elevation-z8" [dataSource]="dataSourceRiesgo">
                            <ng-container matColumnDef="numeroOperacion">
                                <mat-header-cell *matHeaderCellDef> N. Operaciòn </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.numeroOperacion}}</mat-cell>
                            </ng-container>
    
    
                            <ng-container matColumnDef="valorAlDia">
                                <mat-header-cell *matHeaderCellDef> Valor Al Dia </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.valorAlDia}}</mat-cell>
                            </ng-container>
    
                            <ng-container matColumnDef="valorAlDiaMasCuotaActual">
                                <mat-header-cell *matHeaderCellDef> Valor Al Dia Mas Cuota Actual </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.valorAlDiaMasCuotaActual}}</mat-cell>
                            </ng-container>
                            
                            <ng-container matColumnDef="valorCancelaPrestamo">
                                <mat-header-cell *matHeaderCellDef> Valor Cancela Prestamo </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.valorCancelaPrestamo}}</mat-cell>
                            </ng-container>
    
                            <ng-container matColumnDef="valorProyectadoCuotaActual">
                                <mat-header-cell *matHeaderCellDef> Valor Proyectado Cuota Actual </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.valorProyectadoCuotaActual}}</mat-cell>
                            </ng-container>
                            
                            <ng-container matColumnDef="diasMoraActual">
                                <mat-header-cell *matHeaderCellDef> Dias Mora Actual </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.diasMoraActual}}</mat-cell>
                            </ng-container>
                            
                            <ng-container matColumnDef="numeroCuotasTotales">
                                <mat-header-cell *matHeaderCellDef> Numero Cuotas Totales </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.numeroCuotasTotales}}</mat-cell>
                            </ng-container>
    
                            <ng-container matColumnDef="numeroOperacionRelacionada">
                                <mat-header-cell *matHeaderCellDef> Numero Operacion Relacionada </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.numeroOperacionRelacionada}}</mat-cell>
                            </ng-container>
                            
                            <ng-container matColumnDef="nombreProducto">
                                <mat-header-cell *matHeaderCellDef> Nombre Producto </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.nombreProducto}}</mat-cell>
                            </ng-container>
                            
                            <ng-container matColumnDef="numeroCuotasFaltantes">
                                <mat-header-cell *matHeaderCellDef> Numero Cuotas Faltantes </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.numeroCuotasFaltantes}}</mat-cell>
                            </ng-container>
    
                            <ng-container matColumnDef="primeraCuotaVigente">
                                <mat-header-cell *matHeaderCellDef> Primera Cuota Vigente </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.primeraCuotaVigente}}</mat-cell>
                            </ng-container>
    
                            <ng-container matColumnDef="estadoPrimeraCuotaVigente">
                                <mat-header-cell *matHeaderCellDef> Estado Primera Cuota Vigente </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.estadoPrimeraCuotaVigente}}</mat-cell>
                            </ng-container>
    
                            <ng-container matColumnDef="numeroGarantiasReales">
                                <mat-header-cell *matHeaderCellDef> Numero Garantias Reales </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.numeroGarantiasReales}}</mat-cell>
                            </ng-container>
    
                            <ng-container matColumnDef="estadoOperacion">
                                <mat-header-cell *matHeaderCellDef> Estado Operacion </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.estadoOperacion}}</mat-cell>
                            </ng-container>
    
                            <ng-container matColumnDef="idMoneda">
                                <mat-header-cell *matHeaderCellDef> Tipo De Moneda </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.idMoneda}}</mat-cell>
                            </ng-container>
                            
                            <mat-header-row *matHeaderRowDef="displayedColumnsRiesgo"></mat-header-row>
                            <mat-row *matRowDef="let row; columns: displayedColumnsRiesgo;"></mat-row>
                        </mat-table>
                    </div>
                </mat-dialog-content>
            </mat-step>
            <mat-step>
                <ng-template matStepLabel>Excepcion</ng-template>
                <div class="kt-form">
                    <form [formGroup]="formDatosExcepcion">
                        <div class="row mt-3">
                            <div class="col-md-8 ">
                                <mat-card class="warning">{{ tipoExcepcion }}</mat-card>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-8">
                                <mat-label> Observacion Del Asesor:  </mat-label> 
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-xl-8">
                                <textarea class="form-control border" rows="3" [formControl]="observacionAsesor" placeholder="Observacion Del Asesor: " matInput> {{ observacionAsesor }}</textarea>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-8">
                                <mat-label> Observacion Del Asesor:  </mat-label> 
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-xl-8">
                                <textarea class="form-control border" [formControl]="observacionAprobador" rows="5" placeholder="Observacion Del Aprobador: " matInput></textarea>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class=" offset-3 offset-lg-2 col-xl-8">
                              <mat-radio-group [formControl]="radioB" (change)="validarRadio()">
                                <mat-radio-button value="Aprobabo">Aprobar Excepcion</mat-radio-button>
                                <mat-radio-button value="Negado">Negar Excepcion</mat-radio-button>
                              </mat-radio-group>
                            </div>
                        </div>
                    </form>
                </div>
            </mat-step>
        </mat-vertical-stepper>
    </re-portlet-body>
    <re-portlet-footer></re-portlet-footer>
</re-portlet>